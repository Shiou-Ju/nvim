# LSP è‡ªå‹•åŒ–é©—è­‰ç³»çµ±

é€™æ˜¯ä¸€å€‹å…¨è‡ªå‹•åŒ–çš„ LSP (Language Server Protocol) é©—è­‰ç³»çµ±ï¼Œç”¨æ–¼æª¢æ¸¬å’Œå ±å‘Šå„ç¨®ç¨‹å¼èªè¨€çš„ LSP åŠŸèƒ½ç‹€æ…‹ã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹è‰²

- **å…¨è‡ªå‹•é©—è­‰**ï¼šä¸€éµæª¢æ¸¬æ‰€æœ‰é…ç½®çš„ LSP åŠŸèƒ½
- **å¤šèªè¨€æ”¯æ´**ï¼šTypeScriptã€JavaScriptã€Markdownã€Java
- **è©³ç´°æ¸¬è©¦**ï¼šå®šç¾©è·³è½‰ã€hover è³‡è¨Šã€å¼•ç”¨æŸ¥æ‰¾ã€è¨ºæ–·åŠŸèƒ½
- **å¤šç¨®å ±å‘Šæ ¼å¼**ï¼šäººé¡å¯è®€å’Œ JSON æ ¼å¼
- **éŒ¯èª¤è¨ºæ–·**ï¼šç²¾ç¢ºå®šä½å•é¡Œä¸¦æä¾›ä¿®å¾©å»ºè­°

## ğŸ“ æª”æ¡ˆçµæ§‹

```
test/lsp-validation/
â”œâ”€â”€ samples/                    # æ¸¬è©¦æ¨£æœ¬æª”æ¡ˆ
â”‚   â”œâ”€â”€ test.ts                # TypeScript æ¸¬è©¦æª”æ¡ˆ
â”‚   â”œâ”€â”€ test.js                # JavaScript æ¸¬è©¦æª”æ¡ˆ
â”‚   â”œâ”€â”€ test.md                # Markdown æ¸¬è©¦æª”æ¡ˆ
â”‚   â””â”€â”€ Test.java              # Java æ¸¬è©¦æª”æ¡ˆ
â”œâ”€â”€ validate-lsp.lua           # Neovim Lua é©—è­‰è…³æœ¬
â”œâ”€â”€ run-test.sh                # Shell åŒ…è£è…³æœ¬
â””â”€â”€ README.md                  # æœ¬èªªæ˜æª”æ¡ˆ
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### åŸºæœ¬ä½¿ç”¨

```bash
# åŸ·è¡Œå®Œæ•´é©—è­‰ï¼ˆé è¨­å¯è®€æ ¼å¼ï¼‰
./test/lsp-validation/run-test.sh

# è¼¸å‡º JSON æ ¼å¼å ±å‘Š
./test/lsp-validation/run-test.sh -f json

# åŒæ™‚ç”Ÿæˆå…©ç¨®æ ¼å¼å ±å‘Š
./test/lsp-validation/run-test.sh -f both

# è©³ç´°è¼¸å‡ºæ¨¡å¼
./test/lsp-validation/run-test.sh -v

# å„²å­˜å ±å‘Šåˆ°æª”æ¡ˆ
./test/lsp-validation/run-test.sh -o validation_report.txt
```

### åœ¨ Neovim ä¸­ä½¿ç”¨

```vim
" è¼‰å…¥é©—è­‰è…³æœ¬ä¸¦åŸ·è¡Œ
:luafile test/lsp-validation/validate-lsp.lua
:LspValidate

" ç”Ÿæˆ JSON æ ¼å¼å ±å‘Š
:LspValidate json
```

## ğŸ“Š å ±å‘Šæ ¼å¼

### äººé¡å¯è®€æ ¼å¼

```
=== LSP è‡ªå‹•åŒ–é©—è­‰å ±å‘Š ===
åŸ·è¡Œæ™‚é–“: 2025-09-19 14:30:00
Neovim ç‰ˆæœ¬: v0.9.5

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Language    â”‚ Status  â”‚ gd  â”‚ K   â”‚ gr  â”‚ Diag     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ typescript  â”‚ âœ… æ­£å¸¸  â”‚ âœ“   â”‚ âœ“   â”‚ âœ“   â”‚ âœ“        â”‚
â”‚ javascript  â”‚ âœ… æ­£å¸¸  â”‚ âœ“   â”‚ âœ“   â”‚ âœ“   â”‚ âœ“        â”‚
â”‚ markdown    â”‚ âœ… æ­£å¸¸  â”‚ âœ“   â”‚ âœ“   â”‚ âœ“   â”‚ âœ“        â”‚
â”‚ java        â”‚ âš ï¸ æœªè£  â”‚ -   â”‚ -   â”‚ -   â”‚ -        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ•´é«”å¥åº·åº¦: 75% (3/4 å¯ç”¨)
å»ºè­°: å®‰è£ Java LSP ä»¥æ”¯æ´ Java é–‹ç™¼
```

### JSON æ ¼å¼

```json
{
  "timestamp": "2025-09-19T14:30:00Z",
  "nvim_version": "0.9.5",
  "languages": {
    "typescript": {
      "status": "active",
      "clients": ["ts_ls"],
      "tests": {
        "definition": true,
        "hover": true,
        "references": true,
        "diagnostics": true
      },
      "errors": []
    }
  },
  "summary": {
    "total": 4,
    "active": 3,
    "health_score": 0.75
  }
}
```

## ğŸ”§ æ¸¬è©¦é …ç›®

### æ¸¬è©¦çš„ LSP åŠŸèƒ½

1. **å®šç¾©è·³è½‰ (gd)**ï¼šæ¸¬è©¦ `textDocument/definition` è«‹æ±‚
2. **Hover è³‡è¨Š (K)**ï¼šæ¸¬è©¦ `textDocument/hover` è«‹æ±‚
3. **å¼•ç”¨æŸ¥æ‰¾ (gr)**ï¼šæ¸¬è©¦ `textDocument/references` è«‹æ±‚
4. **è¨ºæ–·åŠŸèƒ½**ï¼šæ¸¬è©¦èªæ³•éŒ¯èª¤å’Œè­¦å‘Šé¡¯ç¤º

### æ¸¬è©¦æ¨£æœ¬ç‰¹è‰²

æ¯å€‹æ¸¬è©¦æª”æ¡ˆéƒ½åŒ…å«ï¼š
- å…¸å‹çš„èªæ³•çµæ§‹ï¼ˆå‡½æ•¸ã€è®Šæ•¸ã€é¡åˆ¥ç­‰ï¼‰
- å¤šç¨®å¼•ç”¨å’Œå®šç¾©é—œä¿‚
- æ•…æ„çš„èªæ³•éŒ¯èª¤ï¼ˆæ¸¬è©¦è¨ºæ–·åŠŸèƒ½ï¼‰
- è©³ç´°çš„ JSDoc/è¨»è§£ï¼ˆæ¸¬è©¦ hover åŠŸèƒ½ï¼‰

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### LSP æœå‹™å™¨æœªå•Ÿå‹•
```bash
# æª¢æŸ¥ Mason å®‰è£ç‹€æ…‹
:Mason

# æª¢æŸ¥ LSP é…ç½®
:LspInfo

# é‡æ–°å®‰è£ LSP æœå‹™å™¨
:MasonInstall ts_ls marksman jdtls
```

#### æ¸¬è©¦å¤±æ•—
```bash
# æŸ¥çœ‹è©³ç´°æ—¥èªŒ
./test/lsp-validation/run-test.sh -v

# æª¢æŸ¥æ—¥èªŒæª”æ¡ˆ
cat test/lsp-validation/validation.log
```

#### æ¬Šé™å•é¡Œ
```bash
# ç¢ºä¿è…³æœ¬æœ‰åŸ·è¡Œæ¬Šé™
chmod +x test/lsp-validation/run-test.sh
```

## ğŸ› ï¸ è‡ªè¨‚å’Œæ“´å±•

### æ·»åŠ æ–°èªè¨€æ”¯æ´

1. **å‰µå»ºæ¸¬è©¦æª”æ¡ˆ**ï¼šåœ¨ `samples/` ç›®éŒ„æ·»åŠ æ–°çš„æ¸¬è©¦æª”æ¡ˆ
2. **æ›´æ–°é…ç½®**ï¼šä¿®æ”¹ `validate-lsp.lua` ä¸­çš„ `TEST_CONFIG`
3. **æ·»åŠ æ¸¬è©¦ä½ç½®**ï¼šå®šç¾©æ¸¬è©¦ç¬¦è™Ÿçš„è¡Œè™Ÿå’Œåˆ—è™Ÿ

### ä¿®æ”¹æ¸¬è©¦é‚è¼¯

ç·¨è¼¯ `validate-lsp.lua` ä¸­çš„æ¸¬è©¦å‡½æ•¸ï¼š
- `test_lsp_function()` - ä¿®æ”¹ LSP åŠŸèƒ½æ¸¬è©¦
- `test_diagnostics()` - ä¿®æ”¹è¨ºæ–·æ¸¬è©¦
- `test_language_lsp()` - ä¿®æ”¹èªè¨€ç‰¹å®šæ¸¬è©¦

### è‡ªè¨‚å ±å‘Šæ ¼å¼

ä¿®æ”¹ `generate_readable_report()` æˆ– `generate_json_report()` å‡½æ•¸ä¾†è‡ªè¨‚è¼¸å‡ºæ ¼å¼ã€‚

## ğŸ“‹ ç³»çµ±éœ€æ±‚

- Neovim v0.8.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- å·²é…ç½®çš„ LSP æœå‹™å™¨ï¼ˆts_ls, marksman, jdtls ç­‰ï¼‰
- Bash shell ç’°å¢ƒ

## ğŸ”„ ç›¸é—œ Issues

æ­¤ç³»çµ±è§£æ±ºçš„å•é¡Œï¼š
- [#11](https://github.com/Shiou-Ju/nvim/issues/11) - LSP åŠŸèƒ½é©—è­‰
- [#29](https://github.com/Shiou-Ju/nvim/issues/29) - TypeScript LSP è¨­å®š
- [#30](https://github.com/Shiou-Ju/nvim/issues/30) - LSP å°èˆªåŠŸèƒ½æ¸¬è©¦

## ğŸ¤ è²¢ç»æŒ‡å—

1. Fork å°ˆæ¡ˆ
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯
3. æ·»åŠ æ¸¬è©¦
4. æäº¤ Pull Request

## ğŸ“ æˆæ¬Š

æ­¤å°ˆæ¡ˆä½¿ç”¨ MIT æˆæ¬Šæ¢æ¬¾ã€‚